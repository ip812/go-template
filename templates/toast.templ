package templates

import (
	"github.com/ip812/go-template/templates/icon"
)

templ Toast() {
	<script src="/static/js/toast.js"></script>
	<div x-data="toast" x-init="globalInit($el)">
		<template x-teleport="body">
			<div
				@add-toast.window="add"
				class="fixed z-999 bottom-0 left-1/4 mr-4 mb-4 space-y-2.5 w-1/2"
			>
				<template x-for="toast in toasts" :key="toast.id">
					<div
						:id="toast.id"
						role="alert"
						x-init="toastInit($el)"
						x-show="toast.show"
						x-transition:enter="transition ease-out duration-300"
						x-transition:enter-start="opacity-0 scale-90"
						x-transition:enter-end="opacity-100 scale-100"
						x-transition:leave="transition ease-in duration-300"
						x-transition:leave-start="opacity-100 scale-100"
						x-transition:leave-end="opacity-0 scale-90"
						class="flex font-bold items-center gap-2 p-4 rounded-lg shadow-sm px-5 py-7 break-all"
						:class="toast.statusCode <= 399 
							? 'border border-green-500 bg-green-500 text-white' 
							: 'border border-red-500 bg-red-500 text-white'"
					>
						<div class="flex-shrink-0">
							<div x-show="toast.statusCode <= 399">
								@icon.CircleCheck(icon.Props{Size: 22, Class: "text-white"})
							</div>
							<div x-show="toast.statusCode > 399 && toast.statusCode < 500">
								@icon.TriangleAlert(icon.Props{Size: 22, Class: "text-white"})
							</div>
							<div x-show="toast.statusCode >= 500">
								@icon.CircleX(icon.Props{Size: 22, Class: "text-white"})
							</div>
						</div>

						<p x-text="toast.message" class="text-sm flex-1 text-white"></p>

						<button
							@click="dismiss(toast.id)"
							class="btn btn-sm btn-circle btn-ghost text-white hover:font-extrabold flex-none"
						>
							@icon.X(icon.Props{Size: 20})
						</button>
					</div>
				</template>
			</div>
		</template>
	</div>
}
